- name: Configure DataPower directory paths
  tasks:
    - name: Ensure DataPower config and local directories are defined
      ansible.builtin.lineinfile:
        path: /opt/ibm/datapower/datapower.conf
        # Use a list of lines for concise management of multiple lines
        line: "{{ item }}"
        create: yes # Create the file if it doesn't already exist
        state: present
        owner: root
        group: root
        mode: '0644'
      loop:
        - DataPowerConfigDir=/datapower/config
        - DataPowerLocalDir=/datapower/local
        - DataPowerImageSize=16G
        - DataPowerRaidDevice=/dev/vdb
        - DataPowerAcceptLicense=true
  become: yes

---
- name: Ensure DataPower config and local directories exist
  tasks:
    - name: Create directories /datapower/config and /datapower/local
      ansible.builtin.file:
        path: "{{ item }}"
        state: directory # This tells Ansible to create a directory
        owner: root
        group: root
        mode: '0755' # Standard permissions: read/write/execute for owner, read/execute for group/others
      loop:
        - /datapower/config
        - /datapower/local
  become: yes